<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link href="https://schlegelp.github.io/fastcore-rs/Trees/morphology/" rel="canonical"><link href=../geodesic/ rel=prev><link href=../segments/ rel=next><link rel=icon href=../../assets/images/favicon.png><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.6.7"><title>Morphology - navis-fastcore</title><link rel=stylesheet href=../../assets/stylesheets/main.8608ea7d.min.css><link rel="stylesheet" href="../../assets/external/fonts.googleapis.com/css.49ea35f2.css"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../../assets/_mkdocstrings.css><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><meta property=og:type content=website><meta property=og:title content="Morphology - navis-fastcore"><meta property=og:description content=None><meta property=og:image content=https://schlegelp.github.io/fastcore-rs/assets/images/social/Trees/morphology.png><meta property=og:image:type content=image/png><meta property=og:image:width content=1200><meta property=og:image:height content=630><meta content=https://schlegelp.github.io/fastcore-rs/Trees/morphology/ property=og:url><meta name=twitter:card content=summary_large_image><meta name=twitter:title content="Morphology - navis-fastcore"><meta name=twitter:description content=None><meta name=twitter:image content=https://schlegelp.github.io/fastcore-rs/assets/images/social/Trees/morphology.png> <link href="../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: white; }
    .gscrollbar-fixer { padding-right: 15px; }
    .gdesc-inner { font-size: 0.75rem; }
    body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
    body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
    body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}</style> <script src="../../assets/javascripts/glightbox.min.js"></script></head> <body dir=ltr> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#morphology class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class="md-header md-header--shadow" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../.. title=navis-fastcore class="md-header__button md-logo" aria-label=navis-fastcore data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> navis-fastcore </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Morphology </span> </div> </div> </div> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href="https://github.com/schlegelp/fastcore-rs" title="Go to repository" class="md-source" data-md-component="source"> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg> </div> <div class=md-source__repository> schlegelp/fastcore-rs </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../.. title=navis-fastcore class="md-nav__button md-logo" aria-label=navis-fastcore data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg> </a> navis-fastcore </label> <div class=md-nav__source> <a href="https://github.com/schlegelp/fastcore-rs" title="Go to repository" class="md-source" data-md-component="source"> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg> </div> <div class=md-source__repository> schlegelp/fastcore-rs </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../.. class=md-nav__link> <span class=md-ellipsis> navis-fastcore </span> </a> </li> <li class=md-nav__item> <a href=../../NBLAST/ class=md-nav__link> <span class=md-ellipsis> NBLAST </span> </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3 checked> <div class="md-nav__link md-nav__container"> <a href=../ class="md-nav__link "> <span class=md-ellipsis> Trees </span> </a> <label class="md-nav__link " for=__nav_3 id=__nav_3_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=true> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Trees </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../cc/ class=md-nav__link> <span class=md-ellipsis> Connected Components </span> </a> </li> <li class=md-nav__item> <a href=../geodesic/ class=md-nav__link> <span class=md-ellipsis> Geodesic Distances </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> Morphology </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> Morphology </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#navis_fastcore.synapse_flow_centrality class=md-nav__link> <span class=md-ellipsis> synapse_flow_centrality </span> </a> </li> <li class=md-nav__item> <a href=#navis_fastcore.strahler_index class=md-nav__link> <span class=md-ellipsis> strahler_index </span> </a> </li> <li class=md-nav__item> <a href=#navis_fastcore.prune_twigs class=md-nav__link> <span class=md-ellipsis> prune_twigs </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../segments/ class=md-nav__link> <span class=md-ellipsis> Segments </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../Wrappers/ class=md-nav__link> <span class=md-ellipsis> Wrappers </span> </a> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#navis_fastcore.synapse_flow_centrality class=md-nav__link> <span class=md-ellipsis> synapse_flow_centrality </span> </a> </li> <li class=md-nav__item> <a href=#navis_fastcore.strahler_index class=md-nav__link> <span class=md-ellipsis> strahler_index </span> </a> </li> <li class=md-nav__item> <a href=#navis_fastcore.prune_twigs class=md-nav__link> <span class=md-ellipsis> prune_twigs </span> </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1 id=morphology>Morphology</h1> <p>Functions related to analysing or manipulating neuron morpology.</p> <div class="doc doc-object doc-function"> <h2 id=navis_fastcore.synapse_flow_centrality class="doc doc-heading"> <code class="highlight language-python"><span class=n>navis_fastcore</span><span class=o>.</span><span class=n>synapse_flow_centrality</span><span class=p>(</span><span class=n>node_ids</span><span class=p>,</span> <span class=n>parent_ids</span><span class=p>,</span> <span class=n>presynapses</span><span class=p>,</span> <span class=n>postsynapses</span><span class=p>,</span> <span class=n>mode</span><span class=o>=</span><span class=s1>'sum'</span><span class=p>)</span></code> </h2> <div class="doc doc-contents first"> <p>Calculate synapse flow centrality for this neuron.</p> <p>Please note that this implementation currently produces slightly different results than the implementation in navis. I'm not sure why that is but the differences seem to be negligible.</p> <table> <thead> <tr> <th><span class=doc-section-title>PARAMETER</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>node_ids</code> </td> <td class=doc-param-details> <div class=doc-md-description> <div class="language-text highlight"><pre><span></span><code>     Array of int32 node IDs.
</code></pre></div> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code> (N, ) array</code> </span> </p> </td> </tr> <tr class=doc-section-item> <td> <code>parent_ids</code> </td> <td class=doc-param-details> <div class=doc-md-description> <div class="language-text highlight"><pre><span></span><code>     Array of parent IDs for each node. Root nodes' parents
     must be -1.
</code></pre></div> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code>(N, ) array</code> </span> </p> </td> </tr> <tr class=doc-section-item> <td> <code>presynapses</code> </td> <td class=doc-param-details> <div class=doc-md-description> <div class="language-text highlight"><pre><span></span><code>     Array of number of presynapses associated with each node.
</code></pre></div> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code>(N, ) uint32 array</code> </span> </p> </td> </tr> <tr class=doc-section-item> <td> <code>postsynapses</code> </td> <td class=doc-param-details> <div class=doc-md-description> <div class="language-text highlight"><pre><span></span><code>     Array of number of postsynapses associated with each node.
</code></pre></div> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code>(N, ) uint32 array</code> </span> </p> </td> </tr> <tr class=doc-section-item> <td> <code>mode</code> </td> <td class=doc-param-details> <div class=doc-md-description> <div class="language-text highlight"><pre><span></span><code>     The mode to calculate the flow centrality. "centrifugal" will
     calculate the flow from the root to the leaves, "centripetal"
     will calculate the flow from the leaves to the root, and "sum"
     will calculate the sum of both.
</code></pre></div> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code> "centrifugal" | "centripetal" | "sum"</code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code>'sum'</code> </span> </p> </td> </tr> </tbody> </table> <table> <thead> <tr> <th><span class=doc-section-title>RETURNS</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>cc</code> </td> <td class=doc-returns-details> <div class=doc-md-description> <p>Synapse flow centrality for each node.</p> </div> <p> <span class=doc-returns-annotation> <b>TYPE:</b> <code>(N, ) uint32 array</code> </span> </p> </td> </tr> </tbody> </table> </div> </div> <div class="doc doc-object doc-function"> <h2 id=navis_fastcore.strahler_index class="doc doc-heading"> <code class="highlight language-python"><span class=n>navis_fastcore</span><span class=o>.</span><span class=n>strahler_index</span><span class=p>(</span><span class=n>node_ids</span><span class=p>,</span> <span class=n>parent_ids</span><span class=p>,</span> <span class=n>method</span><span class=o>=</span><span class=s1>'standard'</span><span class=p>,</span> <span class=n>to_ignore</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>min_twig_size</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span></code> </h2> <div class="doc doc-contents first"> <p>Calculcate Strahler Index.</p> <table> <thead> <tr> <th><span class=doc-section-title>PARAMETER</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>node_ids</code> </td> <td class=doc-param-details> <div class=doc-md-description> <div class="language-text highlight"><pre><span></span><code>            Array node IDs.
</code></pre></div> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code> (N, ) array</code> </span> </p> </td> </tr> <tr class=doc-section-item> <td> <code>parent_ids</code> </td> <td class=doc-param-details> <div class=doc-md-description> <div class="language-text highlight"><pre><span></span><code>            Array of parent IDs for each node. Root nodes' parents
            must be -1.
</code></pre></div> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code> (N, ) array</code> </span> </p> </td> </tr> <tr class=doc-section-item> <td> <code>method</code> </td> <td class=doc-param-details> <div class=doc-md-description> <div class="language-text highlight"><pre><span></span><code>            Method used to calculate Strahler indices: 'standard'
            will use the method described above; 'greedy' will
            always increase the index at converging branches
            whether these branches have the same index or not.
</code></pre></div> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code> 'standard' | 'greedy'</code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code>'standard'</code> </span> </p> </td> </tr> <tr class=doc-section-item> <td> <code>to_ignore</code> </td> <td class=doc-param-details> <div class=doc-md-description> <div class="language-text highlight"><pre><span></span><code>            List of node IDs to ignore. Must be the FIRST node
            of the branch. Excluded branches will not contribute
            to Strahler index calculations and instead be assigned
            the SI of their parent branch.
</code></pre></div> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code> iterable</code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code>None</code> </span> </p> </td> </tr> <tr class=doc-section-item> <td> <code>min_twig_size</code> </td> <td class=doc-param-details> <div class=doc-md-description> <div class="language-text highlight"><pre><span></span><code>            If provided, will ignore twigs with fewer nodes than
            this. Instead, they will be assigned the SI of their
            parent branch.
</code></pre></div> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code> int</code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code>None</code> </span> </p> </td> </tr> </tbody> </table> <table> <thead> <tr> <th><span class=doc-section-title>RETURNS</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>strahler_index</code> </td> <td class=doc-returns-details> <div class=doc-md-description> <p>Strahler Index for each node.</p> </div> <p> <span class=doc-returns-annotation> <b>TYPE:</b> <code>(N, ) int array</code> </span> </p> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Examples:</span></p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=gp>&gt;&gt;&gt; </span><span class=kn>import</span><span class=w> </span><span class=nn>navis_fastcore</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>fastcore</span>
</span><span id=__span-0-2><a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a><span class=gp>&gt;&gt;&gt; </span><span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>
</span><span id=__span-0-3><a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a><span class=gp>&gt;&gt;&gt; </span><span class=n>node_ids</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>arange</span><span class=p>(</span><span class=mi>8</span><span class=p>)</span>
</span><span id=__span-0-4><a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a><span class=gp>&gt;&gt;&gt; </span><span class=n>parent_ids</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>([</span><span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>5</span><span class=p>])</span>
</span><span id=__span-0-5><a id=__codelineno-0-5 name=__codelineno-0-5 href=#__codelineno-0-5></a><span class=gp>&gt;&gt;&gt; </span><span class=n>fastcore</span><span class=o>.</span><span class=n>strahler_index</span><span class=p>(</span><span class=n>node_ids</span><span class=p>,</span> <span class=n>parent_ids</span><span class=p>)</span>
</span><span id=__span-0-6><a id=__codelineno-0-6 name=__codelineno-0-6 href=#__codelineno-0-6></a><span class=go>array([2, 2, 1, 1, 2, 2, 1, 1], dtype=int32)</span>
</span></code></pre></div> </div> </div> <div class="doc doc-object doc-function"> <h2 id=navis_fastcore.prune_twigs class="doc doc-heading"> <code class="highlight language-python"><span class=n>navis_fastcore</span><span class=o>.</span><span class=n>prune_twigs</span><span class=p>(</span><span class=n>node_ids</span><span class=p>,</span> <span class=n>parent_ids</span><span class=p>,</span> <span class=n>threshold</span><span class=p>,</span> <span class=n>weights</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>mask</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span></code> </h2> <div class="doc doc-contents first"> <p>Prune twigs shorter than a given threshold.</p> <table> <thead> <tr> <th><span class=doc-section-title>PARAMETER</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>node_ids</code> </td> <td class=doc-param-details> <div class=doc-md-description> <div class="language-text highlight"><pre><span></span><code>     Array node IDs.
</code></pre></div> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code> (N, ) array</code> </span> </p> </td> </tr> <tr class=doc-section-item> <td> <code>parent_ids</code> </td> <td class=doc-param-details> <div class=doc-md-description> <div class="language-text highlight"><pre><span></span><code>     Array of parent IDs for each node. Root nodes' parents
     must be -1.
</code></pre></div> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code>(N, ) array</code> </span> </p> </td> </tr> <tr class=doc-section-item> <td> <code>threshold</code> </td> <td class=doc-param-details> <div class=doc-md-description> <div class="language-text highlight"><pre><span></span><code>     Twigs shorter than this threshold will be pruned.
</code></pre></div> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code> float</code> </span> </p> </td> </tr> <tr class=doc-section-item> <td> <code>weights</code> </td> <td class=doc-param-details> <div class=doc-md-description> <div class="language-text highlight"><pre><span></span><code>     Array of distances for each child -&gt; parent connection.
     If ``None`` all node-to-node distances are set to 1.
</code></pre></div> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code> (N, ) float32 array</code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code>None</code> </span> </p> </td> </tr> <tr class=doc-section-item> <td> <code>mask</code> </td> <td class=doc-param-details> <div class=doc-md-description> <div class="language-text highlight"><pre><span></span><code>     Array of booleans to mask nodes that should not be pruned.
     Importantly, twigs with _any_ masked node will not be pruned.
</code></pre></div> </div> <p> <span class=doc-param-annotation> <b>TYPE:</b> <code> (N, ) bool array</code> </span> <span class=doc-param-default> <b>DEFAULT:</b> <code>None</code> </span> </p> </td> </tr> </tbody> </table> <table> <thead> <tr> <th><span class=doc-section-title>RETURNS</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>keep</code> </td> <td class=doc-returns-details> <div class=doc-md-description> <p>Node IDs to keep.</p> </div> <p> <span class=doc-returns-annotation> <b>TYPE:</b> <code>(M, ) integer array</code> </span> </p> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Examples:</span></p> <div class="language-pycon highlight"><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=gp>&gt;&gt;&gt; </span><span class=kn>import</span><span class=w> </span><span class=nn>navis_fastcore</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>fastcore</span>
</span><span id=__span-0-2><a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a><span class=gp>&gt;&gt;&gt; </span><span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>
</span><span id=__span-0-3><a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a><span class=gp>&gt;&gt;&gt; </span><span class=n>node_ids</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>arange</span><span class=p>(</span><span class=mi>7</span><span class=p>)</span>
</span><span id=__span-0-4><a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a><span class=gp>&gt;&gt;&gt; </span><span class=n>parent_ids</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>([</span><span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>])</span>
</span><span id=__span-0-5><a id=__codelineno-0-5 name=__codelineno-0-5 href=#__codelineno-0-5></a><span class=gp>&gt;&gt;&gt; </span><span class=n>fastcore</span><span class=o>.</span><span class=n>prune_twigs</span><span class=p>(</span><span class=n>node_ids</span><span class=p>,</span> <span class=n>parent_ids</span><span class=p>,</span> <span class=mi>2</span><span class=p>)</span>
</span><span id=__span-0-6><a id=__codelineno-0-6 name=__codelineno-0-6 href=#__codelineno-0-6></a><span class=go>array([0, 1, 4, 5, 6])</span>
</span><span id=__span-0-7><a id=__codelineno-0-7 name=__codelineno-0-7 href=#__codelineno-0-7></a><span class=gp>&gt;&gt;&gt; </span><span class=n>mask</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>([</span><span class=kc>True</span><span class=p>,</span> <span class=kc>True</span><span class=p>,</span> <span class=kc>True</span><span class=p>,</span> <span class=kc>False</span><span class=p>,</span> <span class=kc>True</span><span class=p>,</span> <span class=kc>True</span><span class=p>,</span> <span class=kc>True</span><span class=p>])</span>
</span><span id=__span-0-8><a id=__codelineno-0-8 name=__codelineno-0-8 href=#__codelineno-0-8></a><span class=gp>&gt;&gt;&gt; </span><span class=n>fastcore</span><span class=o>.</span><span class=n>prune_twigs</span><span class=p>(</span><span class=n>node_ids</span><span class=p>,</span> <span class=n>parent_ids</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=n>mask</span><span class=o>=</span><span class=n>mask</span><span class=p>)</span>
</span></code></pre></div> </div> </div> </article> </div> <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> Made with <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener"> Material for MkDocs </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../..", "features": ["content.tabs.link", "content.code.annotate", "navigation.indexes", "navigation.instant", "content.code.copy"], "search": "../../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script> <script src=../../assets/javascripts/bundle.c8b220af.min.js></script> <script id="init-glightbox">document.querySelectorAll('.glightbox').forEach(function(element) {
    try {
        var img = element.querySelector('img');
        if (img && img.src) {
            element.setAttribute('href', img.src);
        } else {
            console.log('No img element with src attribute found');
        }
    } catch (error) {
        console.log('Error:', error);
    }
});
const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(() => { lightbox.reload() });
</script></body> </html>